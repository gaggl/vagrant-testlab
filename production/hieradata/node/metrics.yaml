---
classes:
 - roles::metrics
profiles::metrics::grafana: true
profiles::metrics::grafana::datasources:
  prometheus:
    is_default: true
    type: prometheus
    url: 'http://prometheus.gaggl.vagrant'
    access_mode: proxy
profiles::metrics::grafana::manage_repo: true
profiles::monitoring::prometheus::scrape_configs:
  - job_name: prometheus
    scrape_interval: 30s
    scrape_timeout: 30s
    static_configs:
    - targets:
        - prometheus.gaggl.vagrant:9090
  - job_name: node_exporter
    scrape_interval: 30s
    scrape_timeout: 30s
    static_configs:
    - targets:
        - c.gaggl.vagrant:9100
        - classic.gaggl.vagrant:9100
        - grafana.gaggl.vagrant:9100
        - influxdb.gaggl.vagrant:9100
        - ng.gaggl.vagrant:9100
        - node1.gaggl.vagrant:9100
        - prometheus.gaggl.vagrant:9100
profiles::monitoring::prometheus::server: true
profiles::website::nginx: true
profiles::website::nginx::vhosts:
  grafana.gaggl.vagrant:
    proxy: 'http://127.0.0.1:3000'
  prometheus.gaggl.vagrant:
    proxy:  'http://127.0.0.1:9090'
